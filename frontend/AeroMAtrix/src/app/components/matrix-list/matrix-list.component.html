<div class="matrix-list-container">
  <p-toolbar>
    <div class="p-toolbar-group-left">
      <h1>Flight Matrices</h1>
    </div>
    <div class="p-toolbar-group-right">
      <button
        pButton
        pRipple
        label="Create New Matrix"
        icon="pi pi-plus"
        class="p-button-success"
        type="button"
        title="Create New Matrix"
        (click)="showCreateDialog()"
      ></button>
    </div>
  </p-toolbar>

  <div class="card mt-4">
    <p-table
      [value]="matrices"
      [loading]="loading"
      styleClass="p-datatable-gridlines p-datatable-sm"
      [paginator]="matrices.length > 10"
      [rows]="10"
      responsiveLayout="scroll"
    >
          <th scope="col">ID</th>
          <th scope="col">Dimensions</th>
          <th scope="col">Drones</th>
          <th scope="col">Actions</th>
          <th>Drones</th>
          <th>Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-matrix>
        <tr>
          <td>{{ matrix.id }}</td>
          <td>{{ matrix.maxX }} x {{ matrix.maxY }}</td>
          <td>{{ matrix.drones?.length || 0 }}</td>
              <button
                pButton
                pRipple
                icon="pi pi-eye"
                class="p-button-rounded p-button-info p-button-sm mr-2"
                type="button"
                title="View Details"
                (click)="viewMatrix(matrix)"
              <button
                pButton
                pRipple
                icon="pi pi-trash"
                class="p-button-rounded p-button-danger p-button-sm"
                type="button"
                title="Delete"
                (click)="deleteMatrix(matrix)"
                pTooltip="Delete"
                [disabled]="matrix.drones?.length > 0"
              ></button>
                (click)="deleteMatrix(matrix)"
                pTooltip="Delete"
                [disabled]="matrix.drones?.length > 0"
              ></button>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="4" class="text-center">
            <div *ngIf="!loading" class="empty-message">
              <p>No matrices found</p>
              <button
                pButton
                pRipple
                label="Create First Matrix"
                icon="pi pi-plus"
                class="p-button-success"
                (click)="showCreateDialog()"
                type="button"
                title="Create First Matrix"
              ></button>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <p-dialog
    header="Create New Matrix"
    [(visible)]="displayCreateDialog"
    [modal]="true"
    [style]="{ width: '450px' }"
    [draggable]="false"
    [resizable]="false"
  >
    <app-matrix-form
      (matrixCreated)="onMatrixCreated()"
      (cancel)="hideCreateDialog()"
    ></app-matrix-form>
  </p-dialog>
</div>
